@page
@inject Mozlite.Extensions.Settings.ISettingsManager SettingsManager
@model LogModel
@{
    ViewData["Title"] = "活动日志";
    ViewData["Current"] = AccountMenu.Index;
}

@inject ILocalizer Localizer

<div class="panel panel-primary nav-panel" data-collapsed="0">
    <ul class="nav nav-tabs tab-right-border">
        <li><a asp-page="./Index" asp-area="@SecuritySettings.ExtensionName">编辑资料</a></li>
        <li><a asp-page="./ChangePassword" asp-area="@SecuritySettings.ExtensionName">修改密码</a></li>
        <li><a asp-page="./Avatar" asp-area="@SecuritySettings.ExtensionName">更新头像</a></li>
        <li class="active"><a asp-page="./Log" asp-area="@SecuritySettings.ExtensionName">活动日志</a></li>
    </ul>
    <div class="panel-body">
        <div class="filter d-print-none">
            <form class="left" method="get">
                <label>分类：</label><moz:range-dropdownlist default-text="全部" from="1" to="@SecuritySettings.MaxEventId" resource="EventID" class="form-control" for="Model.Cid"></moz:range-dropdownlist>
                <label>日期：</label><input autocomplete="off" class="form-control" js-date="datetime" js-date-max="#Model_End" type="text" asp-for="Model.Start" />
                <label>-</label>
                <div class="input-group">
                    <input autocomplete="off" js-date="datetime" js-date-min="#Model_Start" class="form-control" type="text" asp-for="Model.End" />
                    <div class="input-group-btn">
                        <button class="btn btn-default" type="submit">
                            <span class="fa fa-search"></span>
                        </button>
                    </div>
                </div>
            </form>
            <div class="right">
                <a title="打印" href="javascript:;" onclick="print();" class="btn btn-default"><i class="fa fa-print"></i></a>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-striped table-bordered data-view" js-actionbar=".filter">
                <thead>
                    <tr>
                        <th>分类</th>
                        <th>日志信息</th>
                    </tr>
                </thead>
                <tbody class="data-content">
                    @foreach (var activity in Model.Model)
                    {
                        <tr>
                            <td class="text-center">@Localizer["EventID_" + activity.CategoryId]</td>
                            <td>[@activity.CreatedDate.ToString("yyyy-MM-dd HH:mm")] @Html.Raw(activity.Activity)</td>
                        </tr>
                    }
                    <moz:warning-tabled class="text-secondary" attach="Model.Model">没有查询到相关日志！</moz:warning-tabled>
                </tbody>
            </table>

            <moz:page class="pagination-sm d-print-none mb-0" data="Model.Model"></moz:page>
        </div>
    </div>
</div>